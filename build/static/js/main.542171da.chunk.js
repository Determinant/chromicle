(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{308:function(e,a,t){e.exports=t(655)},655:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),l=t(28),c=t.n(l),o=t(307),i=t(168),s=t(169),u=t(176),m=t(170),d=t(177),h=t(175),p=(t(313),t(315),t(341),t(285)),g=(t(5),t(56)),f=t(129),v=t.n(f),E=t(128),x=t.n(E),y=t(298),b=t.n(y),w=t(300),P=t.n(w),S=t(299),C=t.n(S),D=t(166),k=t.n(D),R=t(173),O=t.n(R),j=t(76),G=t.n(j),N=t(302),T=t.n(N),I=t(304),B=t.n(I),W=t(131),_=t.n(W),A=t(93),M=t.n(A),z=t(303),F=t.n(z),H=t(306),q=t.n(H),L=t(174),$=t.n(L),J=t(165),U=t.n(J),V=t(95),X=t.n(V),Y=t(43),K=t.n(Y),Q=t(305),Z=t.n(Q),ee=t(301),ae=t.n(ee),te=t(167),ne=t.n(te),re=t(164),le=t.n(re),ce=t(123),oe=t.n(ce),ie=t(660),se=t(656),ue=t(657),me=t(558),de=function(e){return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 98.905998 93.557997",version:"1.1",style:e.style},r.a.createElement("g",{id:"g13",transform:"translate(-153.533,-203.047)"},r.a.createElement("g",{id:"g29"},r.a.createElement("g",{id:"g27"},r.a.createElement("polygon",{id:"polygon7",points:"252.439,241.924 234.556,288.703 185.103,296.605 153.533,257.728 171.416,210.949 220.869,203.047 ",style:{fill:"#ff8000"}}),r.a.createElement("g",{id:"g11",transform:"translate(167.24355,224.20734)"},r.a.createElement("text",{id:"text9",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:75,fontFamily:"TypoPRO Fantasque Sans Mono",fill:"#ffeade"},transform:"translate(0.586,49.072)"},"Cr"))))))},he=[{name:"Work",value:10,color:x.a[300]},{name:"Wasted",value:10,color:x.a[300]}],pe="https://www.googleapis.com/calendar/v3",ge=Object(g.createMuiTheme)({palette:{primary:{light:v.a[300],main:v.a[500],dark:v.a[700],contrastText:"#fff"}}});function fe(e){return Object.entries(e).map(function(e){var a=Object(h.a)(e,2),t=a[0],n=a[1];return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&")}function ve(e){return fetch(pe+"/users/me/calendarList?"+fe({access_token:e}),{method:"GET",async:!0}).then(function(e){return e.json()}).then(function(e){return e.items})}function Ee(e){return fetch(pe+"/colors?"+fe({access_token:e}),{method:"GET",async:!0}).then(function(e){return e.json()})}function xe(e){var a=e.cx,t=e.cy,n=e.x,l=e.y,c=(e.stroke,e.fill),o=e.name,i=(e.value,"middle"),s=0,u=0;return n<a-2?(s=-5,i="end"):n>a+2&&(s=5,i="start"),l<t-2?u=-5:l>t+2&&(u=10),r.a.createElement("text",{x:n,y:l,dx:s,dy:u,fill:c,textAnchor:i},"".concat(o))}function ye(e){return r.a.createElement(K.a,{container:!0,spacing:0},r.a.createElement(K.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(ie.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(se.a,{data:e.patternGraphData,cx:200,cy:125,outerRadius:60,fill:b.a[300],label:xe}),r.a.createElement(ue.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}})))),r.a.createElement(K.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(ie.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(se.a,{data:e.calendarGraphData,cx:200,cy:125,innerRadius:40,outerRadius:70,fill:x.a[300],label:xe},e.calendarGraphData.map(function(e){return r.a.createElement(me.a,{fill:e.color})})),r.a.createElement(ue.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}})))))}var be=function(e){function a(){return Object(i.a)(this,a),Object(u.a)(this,Object(m.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,a=this.props.items,t=[];for(var n in a[0]={regex:!0,label:null,id:"0"},a)t.push(r.a.createElement(le.a,{key:n,value:n},null!=a[n].label&&a[n].label||"Regex"));return r.a.createElement("span",null,r.a.createElement(oe.a,{value:this.props.value.id,onChange:function(t){var n;n=null==a[t.target.value].label?e.props.value.regex?{regex:!0,value:e.props.value.value,label:null,id:"0"}:{regex:!0,value:"^".concat(e.props.value.value,"$"),label:null,id:"0"}:a[t.target.value],e.props.onChange({target:{value:n}})},className:this.props.value.regex&&this.props.fieldStyles.regex||this.props.fieldStyles.noRegex},t),null==this.props.value.label&&r.a.createElement(O.a,{value:this.props.value.value,onChange:function(a){return e.props.onChange({target:{value:{regex:!0,value:a.target.value,label:null,id:"0"}}})}}))}}]),a}(r.a.Component);var we=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(u.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={open:!0,patterns:[],page:0,rowsPerPage:5,timeRange:null,token:new Promise(function(e){return chrome.identity.getAuthToken({interactive:!0},function(a){return e(a)})}),patternGraphData:he,calendarGraphData:he,activePattern:null},t.cached={calendars:{}},t.handleChangePage=function(e,a){t.setState({page:a})},t.handleChangeRowsPerPage=function(e){t.setState({rowsPerPage:e.target.value})},t.updatePattern=function(e,a,n){var r=t.state.patterns;r[a][e]=n,t.setState({patterns:r})},t.removePattern=function(e){var a=t.state.patterns;a.splice(e,1);for(var n=0;n<a.length;n++)a[n].idx=n;t.setState({patterns:a})},t.newPattern=function(){for(var e=[{name:"",cal:{regex:!0,label:null,id:"0"},event:{regex:!0,value:".*",label:"Any",id:"any"},idx:0}].concat(Object(o.a)(t.state.patterns)),a=1;a<e.length;a++)e[a].idx=a;t.setState({patterns:e})},t.analyze=function(){if(t.state.startDate&&t.state.endDate){var e=t.state.startDate.toISOString(),a=t.state.endDate.toISOString(),n=[],r=function(r){var l,c,o;n.push(t.state.token.then((l=r,c=e,o=a,function(e){return fetch(pe+"/calendars/"+l+"/events?"+fe({access_token:e,timeMin:c,timeMax:o}),{method:"GET",async:!0}).then(function(e){return e.json()}).then(function(e){return e.items})})).then(function(e){return t.cached.calendars[r].events=e}))};for(var l in t.cached.calendars)r(l);Promise.all(n).then(function(){for(var e={},a={},n=0;n<t.state.patterns.length;n++)e[n]=0;var r=function(n){var r=function(e,a){return e.filter(function(e){return new RegExp(e.cal.regex&&e.cal.value||"^".concat(e.cal.value,"$")).test(a)})}(t.state.patterns,t.cached.calendars[n].name).map(function(e){return{regex:new RegExp(e.event.value),idx:e.idx}});if(!t.cached.calendars[n].events)return"continue";t.cached.calendars[n].events.forEach(function(t){"confirmed"==t.status&&r.forEach(function(r){if(r.regex.test(t.summary)){void 0===a[n]&&(a[n]=0);var l=(new Date(t.end.dateTime)-new Date(t.start.dateTime))/6e4;e[r.idx]+=l,a[n]+=l}})})};for(var l in t.cached.calendars)r(l);for(var c=[],o=[],i=0;i<t.state.patterns.length;i++)c.push({name:t.state.patterns[i].name,value:e[i]/60});for(var l in a)o.push({name:t.cached.calendars[l].name,value:a[l]/60,color:t.cached.calendars[l].color.background});t.setState({patternGraphData:c,calendarGraphData:o})})}else alert("Please choose a valid time range.")},t.loadPatterns=function(){var e=t.state.token,a=e.then(Ee).then(function(e){return e.calendar}),n=e.then(ve);Promise.all([a,n]).then(function(e){var a=Object(h.a)(e,2),n=a[0],r=a[1];r.forEach(function(e){t.cached.calendars[e.id]={name:e.summary,events:{},color:n[e.colorId]}}),t.setState({patterns:r.map(function(e,a){return{name:e.summary,cal:{regex:!1,value:e.summary,label:e.summary,id:e.id},event:{regex:!0,value:".*",label:"Any",id:"any"},idx:a}})})})},t}return Object(d.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,l=n.patterns,c=(n.rows,n.rowsPerPage),o=n.page,i=c-Math.min(c,l.length-o*c);return r.a.createElement(g.MuiThemeProvider,{theme:ge},r.a.createElement("div",{className:t.root},r.a.createElement(C.a,{position:"absolute",className:t.appBar},r.a.createElement(k.a,{disableGutters:!this.state.open,className:t.toolbar},r.a.createElement(G.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:t.title},r.a.createElement(de,{style:{width:"2em",verticalAlign:"bottom",marginRight:"0.2em"}}),"Chromicle"))),r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.appBarSpacer}),r.a.createElement(K.a,{container:!0,spacing:16},r.a.createElement(P.a,null),r.a.createElement(K.a,{item:!0,md:6,xs:12},r.a.createElement(U.a,{fullWidth:!0},r.a.createElement(X.a,null,r.a.createElement(G.a,{variant:"h6",component:"h1",gutterBottom:!0},"Event Patterns",r.a.createElement(ne.a,{style:{marginBottom:"0.12em",marginLeft:"0.5em"},onClick:function(){return e.newPattern()}},r.a.createElement(ae.a,null))),r.a.createElement("div",{className:t.patternTableWrapper},r.a.createElement(T.a,{className:t.patternTable},r.a.createElement(F.a,null,r.a.createElement(_.a,null,a.patternHead.map(function(e){return r.a.createElement(M.a,null,e.label)}))),r.a.createElement(B.a,null,l.slice(o*c,(o+1)*c).map(function(n){return r.a.createElement(_.a,{onMouseOver:function(){return e.setState({activePattern:n.idx})},onMouseOut:function(){return e.setState({activePattern:null})}},a.patternHead.map(function(a){var l=a.elem;return r.a.createElement(M.a,null,r.a.createElement(l,{value:n[a.field],cached:e.cached,fieldStyles:{noRegex:t.fieldNoRegex,regex:t.fieldRegex},onChange:function(t){return e.updatePattern(a.field,n.idx,t.target.value)}}))}),r.a.createElement("span",{style:e.state.activePattern==n.idx&&{position:"absolute",right:0,height:48}||{display:"none"}},r.a.createElement(Z.a,{style:{height:"100%",cursor:"pointer"},onClick:function(){return e.removePattern(n.idx)}})))}),i>0&&r.a.createElement(_.a,{style:{height:48*i}},r.a.createElement(M.a,{colSpan:a.patternHead.length}))))),r.a.createElement(q.a,{rowsPerPageOptions:[5,10,25],component:"div",count:l.length,rowsPerPage:c,page:o,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage})),r.a.createElement(X.a,null,r.a.createElement(G.a,{variant:"h6",component:"h1",gutterBottom:!0},"Time Range"),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(p.DateRangePicker,{startDate:this.state.startDate,startDateId:"your_unique_start_date_id",endDate:this.state.endDate,endDateId:"your_unique_end_date_id",onDatesChange:function(a){var t=a.startDate,n=a.endDate;e.setState({startDate:t,endDate:n})},focusedInput:this.state.focusedInput,onFocusChange:function(a){return e.setState({focusedInput:a})},isOutsideRange:function(){return!1}}))),r.a.createElement("div",{className:t.buttonSpacer}),r.a.createElement(K.a,{container:!0,spacing:16},r.a.createElement(K.a,{item:!0,md:6,xs:12},r.a.createElement(X.a,null,r.a.createElement($.a,{variant:"contained",color:"primary",onClick:this.loadPatterns},"Load"))),r.a.createElement(K.a,{item:!0,md:6,xs:12},r.a.createElement(X.a,null,r.a.createElement($.a,{variant:"contained",color:"primary",onClick:this.analyze},"Analyze")))))),r.a.createElement(K.a,{item:!0,md:6,xs:12},r.a.createElement(G.a,{variant:"h6",component:"h1",gutterBottom:!0},"Graph"),r.a.createElement(ye,{patternGraphData:this.state.patternGraphData,calendarGraphData:this.state.calendarGraphData,classes:t}))))))}}]),a}(r.a.Component);we.patternHead=[{label:"Name",field:"name",elem:O.a},{label:"Calendar",field:"cal",elem:function(e){var a={};for(var t in e.cached.calendars)a[t]={regex:!1,value:e.cached.calendars[t].name,label:e.cached.calendars[t].name,id:t};return r.a.createElement(be,{value:e.value,items:a,fieldStyles:e.fieldStyles,onChange:e.onChange})}},{label:"Event",field:"event",elem:function(e){return r.a.createElement(be,{value:e.value,items:{any:{regex:!0,value:".*",label:"Any",id:"any"}},fieldStyles:e.fieldStyles,onChange:e.onChange})}}];var Pe=Object(g.withStyles)(function(e){return{root:{display:"flex",height:"100vh"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},title:{flexGrow:1},sectionTitle:{flex:"0 0 auto"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,padding:3*e.spacing.unit,overflow:"auto"},buttonSpacer:{marginBottom:4*e.spacing.unit},patternTableWrapper:{overflowX:"auto",overflowY:"hidden"},patternTable:{minWidth:600},pieChart:{margin:"0 auto"},fab:{margin:e.spacing.unit},fieldNoRegex:{width:200},fieldRegex:{marginRight:"0.5em"}}})(we);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[308,2,1]]]);
//# sourceMappingURL=main.542171da.chunk.js.map