(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{308:function(e,t,a){e.exports=a(655)},655:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(28),o=a.n(l),c=a(134),i=a(307),s=a(57),u=a(73),m=a(135),h=a(128),d=a(136),p=(a(313),a(315),a(341),a(285)),f=a(38),g=a(138),v=a.n(g),E=a(96),y=a.n(E),w=a(300),x=a.n(w),b=a(299),P=a.n(b),S=a(173),C=a.n(S),D=a(133),O=a.n(D),k=a(78),j=a.n(k),R=a(302),T=a.n(R),N=a(304),G=a.n(N),I=a(139),B=a.n(I),W=a(97),_=a.n(W),M=a(303),A=a.n(M),z=a(306),F=a.n(z),H=a(177),q=a.n(H),L=a(90),$=a.n(L),J=a(99),K=a.n(J),U=a(39),V=a.n(U),X=a(305),Y=a.n(X),Q=a(301),Z=a.n(Q),ee=a(174),te=a.n(ee),ae=function(e){return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 98.905998 93.557997",version:"1.1",style:e.style},r.a.createElement("g",{id:"g13",transform:"translate(-153.533,-203.047)"},r.a.createElement("g",{id:"g29"},r.a.createElement("g",{id:"g27"},r.a.createElement("polygon",{id:"polygon7",points:"252.439,241.924 234.556,288.703 185.103,296.605 153.533,257.728 171.416,210.949 220.869,203.047 ",style:{fill:"#ff8000"}}),r.a.createElement("g",{id:"g11",transform:"translate(167.24355,224.20734)"},r.a.createElement("text",{id:"text9",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:75,fontFamily:"TypoPRO Fantasque Sans Mono",fill:"#ffeade"},transform:"translate(0.586,49.072)"},"Cr"))))))},ne="https://www.googleapis.com/calendar/v3";function re(e){return Object.entries(e).map(function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(n))}).join("&")}function le(e){return fetch(ne+"/users/me/calendarList?"+re({access_token:e}),{method:"GET",async:!0}).then(function(e){return e.json()}).then(function(e){return e.items})}function oe(e){return fetch(ne+"/colors?"+re({access_token:e}),{method:"GET",async:!0}).then(function(e){return e.json()})}var ce=function(){function e(t,a,n,r){Object(s.a)(this,e),this.id=t,this.isRegex=a,this.value=n,this.label=r}return Object(u.a)(e,[{key:"regex",get:function(){return new RegExp(this.isRegex?this.value:"^".concat(this.value,"$"))}},{key:"isEmpty",get:function(){return null===this.label}}]),e}();ce.emptyPattern=function(){return new ce(0,!0,"",null)},ce.anyPattern=function(){return new ce("any",!0,".*","Any")};var ie=function e(t,a,n,r){Object(s.a)(this,e),this.name=t,this.idx=a,this.cal=n,this.event=r};ie.defaultPatternEntry=function(e){return new ie("",e,ce.emptyPattern(),ce.anyPattern())};var se=a(298),ue=a.n(se),me=a(659),he=a(656),de=a(657),pe=a(554);function fe(e){var t=e.cx,a=e.cy,n=e.x,l=e.y,o=e.fill,c=e.name,i="middle",s=0,u=0;return n<t-2?(s=-5,i="end"):n>t+2&&(s=5,i="start"),l<a-2?u=-5:l>a+2&&(u=10),r.a.createElement("text",{x:n,y:l,dx:s,dy:u,fill:o,textAnchor:i},"".concat(c))}var ge=Object(f.withStyles)(function(e){return{pieChart:{margin:"0 auto"}}})(function(e){return r.a.createElement(V.a,{container:!0,spacing:0},r.a.createElement(V.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(me.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(he.a,{data:e.patternGraphData,dataKey:"value",cx:200,cy:125,outerRadius:60,fill:ue.a[300],label:fe}),r.a.createElement(de.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}})))),r.a.createElement(V.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(me.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(he.a,{data:e.calendarGraphData,dataKey:"value",cx:200,cy:125,innerRadius:40,outerRadius:70,fill:y.a[300],label:fe},e.calendarGraphData.map(function(e,t){return r.a.createElement(pe.a,{key:t,fill:e.color})})),r.a.createElement(de.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}})))))}),ve=a(127),Ee=a.n(ve),ye=a(172),we=a.n(ye),xe=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.options,a=new ce.emptyPattern,n=[];for(var l in t[a.id]=a,t)n.push(r.a.createElement(we.a,{key:l,value:l},t[l].isEmpty?r.a.createElement("span",{style:{color:this.props.theme.palette.primary.dark}},"Custom"):t[l].label));return r.a.createElement($.a,null,r.a.createElement("span",null,r.a.createElement(Ee.a,{value:this.props.value.id,onChange:function(a){var n;n=null==t[a.target.value].label?new ce(0,!0,e.props.value.isRegex?e.props.value.value:"^".concat(e.props.value.value,"$"),null):t[a.target.value],e.props.onChange({target:{value:n}})},className:this.props.value.isRegex?this.props.fieldStyles.regex:this.props.fieldStyles.noRegex},n),null==this.props.value.label&&r.a.createElement(O.a,{value:this.props.value.value,onChange:function(t){return e.props.onChange({target:{value:new ce(0,!0,t.target.value,null)}})}})))}}]),t}(r.a.Component);var be=[{name:"Work",value:10,color:y.a[300]},{name:"Wasted",value:10,color:y.a[300]}],Pe=Object(f.createMuiTheme)({palette:{primary:{light:v.a[300],main:v.a[500],dark:v.a[700],contrastText:"#fff"}},typography:{useNextVariants:!0}});var Se=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={open:!0,patterns:[],page:0,rowsPerPage:5,timeRange:null,token:new Promise(function(e){return chrome.identity.getAuthToken({interactive:!0},function(t){return e(t)})}),patternGraphData:be,calendarGraphData:be,activePattern:null},a.cached={calendars:{}},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.updatePattern=function(e,t,n){var r=a.state.patterns;r[t][e]=n,a.setState({patterns:r})},a.removePattern=function(e){var t=a.state.patterns;t.splice(e,1);for(var n=0;n<t.length;n++)t[n].idx=n;a.setState({patterns:t})},a.newPattern=function(){for(var e=[ie.defaultPatternEntry()].concat(Object(i.a)(a.state.patterns)),t=1;t<e.length;t++)e[t].idx=t;a.setState({patterns:e})},a.analyze=function(){if(a.state.startDate&&a.state.endDate){var e=a.state.startDate.toISOString(),t=a.state.endDate.toISOString(),n=[],r=function(r){var l,o,c;n.push(a.state.token.then((l=r,o=e,c=t,function(e){return fetch(ne+"/calendars/"+l+"/events?"+re({access_token:e,timeMin:o,timeMax:c}),{method:"GET",async:!0}).then(function(e){if(200===e.status)return e.json();throw"got response ".concat(e.status)}).catch(function(e){return console.log(e),[]}).then(function(e){return e.items})})).then(function(e){return a.cached.calendars[r].events=e}))};for(var l in a.cached.calendars)r(l);Promise.all(n).then(function(){for(var e={},t={},n=0;n<a.state.patterns.length;n++)e[n]=0;var r=function(n){var r=function(e,t){return e.filter(function(e){return e.cal.regex.test(t)})}(a.state.patterns,a.cached.calendars[n].name);if(!a.cached.calendars[n].events)return"continue";a.cached.calendars[n].events.forEach(function(a){"confirmed"===a.status&&r.forEach(function(r){if(r.event.regex.test(a.summary)){void 0===t[n]&&(t[n]=0);var l=(new Date(a.end.dateTime)-new Date(a.start.dateTime))/6e4;e[r.idx]+=l,t[n]+=l}})})};for(var l in a.cached.calendars)r(l);for(var o=[],c=[],i=0;i<a.state.patterns.length;i++)o.push({name:a.state.patterns[i].name,value:e[i]/60});for(var l in t)c.push({name:a.cached.calendars[l].name,value:t[l]/60,color:a.cached.calendars[l].color.background});a.setState({patternGraphData:o,calendarGraphData:c})})}else alert("Please choose a valid time range.")},a.loadPatterns=function(){var e=a.state.token,t=e.then(oe).then(function(e){return e.calendar}),n=e.then(le);Promise.all([t,n]).then(function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];r.forEach(function(e){a.cached.calendars[e.id]={name:e.summary,events:{},color:n[e.colorId]}}),a.setState({patterns:r.map(function(e,t){return new ie(e.summary,t,new ce(e.id,!1,e.summary,e.summary),ce.anyPattern())})})})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,a=this.props.classes,n=this.state,l=n.patterns,o=(n.rows,n.rowsPerPage),c=n.page,i=o-Math.min(o,l.length-c*o);return r.a.createElement(f.MuiThemeProvider,{theme:Pe},r.a.createElement("div",{className:a.root},r.a.createElement(P.a,{position:"absolute",className:a.appBar},r.a.createElement(C.a,{disableGutters:!this.state.open,className:a.toolbar},r.a.createElement(j.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:a.title},r.a.createElement(ae,{style:{width:"2em",verticalAlign:"bottom",marginRight:"0.2em"}}),"Chromicle"))),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.appBarSpacer}),r.a.createElement(V.a,{container:!0,spacing:16},r.a.createElement(x.a,null),r.a.createElement(V.a,{item:!0,md:6,xs:12},r.a.createElement($.a,{fullWidth:!0},r.a.createElement(K.a,null,r.a.createElement(j.a,{variant:"h6",component:"h1",gutterBottom:!0},"Event Patterns",r.a.createElement(te.a,{style:{marginBottom:"0.12em",marginLeft:"0.5em"},onClick:function(){return e.newPattern()}},r.a.createElement(Z.a,null))),r.a.createElement("div",{className:a.patternTableWrapper},r.a.createElement(T.a,{className:a.patternTable},r.a.createElement(A.a,null,r.a.createElement(B.a,null,t.patternHead.map(function(e,t){return r.a.createElement(_.a,{key:t},e.label)}))),r.a.createElement(G.a,null,l.slice(c*o,(c+1)*o).map(function(n){return r.a.createElement(B.a,{onMouseOver:function(){return e.setState({activePattern:n.idx})},onMouseOut:function(){return e.setState({activePattern:null})}},t.patternHead.map(function(t){var l=t.elem;return r.a.createElement(_.a,null,r.a.createElement(l,{value:n[t.field],cached:e.cached,fieldStyles:{noRegex:a.fieldNoRegex,regex:a.fieldRegex},onChange:function(a){return e.updatePattern(t.field,n.idx,a.target.value)}}))}),r.a.createElement("span",{style:e.state.activePattern===n.idx&&{position:"absolute",right:0,height:48}||{display:"none"}},r.a.createElement(Y.a,{style:{height:"100%",cursor:"pointer"},onClick:function(){return e.removePattern(n.idx)}})))}),i>0&&r.a.createElement(B.a,{style:{height:48*i}},r.a.createElement(_.a,{colSpan:t.patternHead.length}))))),r.a.createElement(F.a,{rowsPerPageOptions:[5,10,25],component:"div",count:l.length,rowsPerPage:o,page:c,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage})),r.a.createElement(K.a,null,r.a.createElement(j.a,{variant:"h6",component:"h1",gutterBottom:!0},"Time Range"),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(p.DateRangePicker,{startDate:this.state.startDate,startDateId:"your_unique_start_date_id",endDate:this.state.endDate,endDateId:"your_unique_end_date_id",onDatesChange:function(t){var a=t.startDate,n=t.endDate;e.setState({startDate:a,endDate:n})},focusedInput:this.state.focusedInput,onFocusChange:function(t){return e.setState({focusedInput:t})},isOutsideRange:function(){return!1}}))),r.a.createElement("div",{className:a.buttonSpacer}),r.a.createElement(V.a,{container:!0,spacing:16},r.a.createElement(V.a,{item:!0,md:6,xs:12},r.a.createElement(K.a,null,r.a.createElement(q.a,{variant:"contained",color:"primary",onClick:this.loadPatterns},"Load"))),r.a.createElement(V.a,{item:!0,md:6,xs:12},r.a.createElement(K.a,null,r.a.createElement(q.a,{variant:"contained",color:"primary",onClick:this.analyze},"Analyze")))))),r.a.createElement(V.a,{item:!0,md:6,xs:12},r.a.createElement(j.a,{variant:"h6",component:"h1",gutterBottom:!0},"Graph"),r.a.createElement(ge,{patternGraphData:this.state.patternGraphData,calendarGraphData:this.state.calendarGraphData}))))))}}]),t}(r.a.Component);Se.patternHead=[{label:"Name",field:"name",elem:O.a},{label:"Calendar",field:"cal",elem:Object(f.withTheme)(Pe)(function(e){var t={};for(var a in e.cached.calendars)t[a]=new ce(a,!1,e.cached.calendars[a].name,e.cached.calendars[a].name);return r.a.createElement(xe,{value:e.value,options:t,fieldStyles:e.fieldStyles,onChange:e.onChange,theme:e.theme})})},{label:"Event",field:"event",elem:Object(f.withTheme)(Pe)(function(e){var t=ce.anyPattern(),a={};return a[t.id]=t,r.a.createElement(xe,{value:e.value,options:a,fieldStyles:e.fieldStyles,onChange:e.onChange,theme:e.theme})})}];var Ce=Object(f.withStyles)(function(e){return{root:{display:"flex",height:"100vh"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},title:{flexGrow:1},sectionTitle:{flex:"0 0 auto"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,padding:3*e.spacing.unit,overflow:"auto"},buttonSpacer:{marginBottom:4*e.spacing.unit},patternTableWrapper:{overflowX:"auto",overflowY:"hidden"},patternTable:{minWidth:600},fab:{margin:e.spacing.unit},fieldNoRegex:{width:200},fieldRegex:{marginRight:"0.5em"}}})(Se);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[308,2,1]]]);
//# sourceMappingURL=main.a4bfd80e.chunk.js.map