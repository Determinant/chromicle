!function(e){function t(t){for(var a,i,o=t[0],u=t[1],c=t[2],f=0,d=[];f<o.length;f++)i=o[f],r[i]&&d.push(r[i][0]),r[i]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);for(l&&l(t);d.length;)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={4:0},s=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window.webpackJsonp=window.webpackJsonp||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([853,0,1]),n()}({247:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}}).call(this,n(319))},28:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",function(){return h}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return j});var i="updatePatterns",o="getPatterns",u="updateCalendars",c="getCalendars",l="getCalEvents",f="updateConfig",d="getConfig",h=Object.freeze({updatePatterns:Symbol(i),getPatterns:Symbol(o),updateCalendars:Symbol(u),getCalendars:Symbol(c),getCalEvents:Symbol(l),updateConfig:Symbol(f),getConfig:Symbol(d)});function p(e){switch(e){case h.updatePatterns:return i;case h.getPatterns:return o;case h.updateCalendars:return u;case h.getCalendars:return c;case h.getCalEvents:return l;case h.updateConfig:return f;case h.getConfig:return d;default:console.error("unreachable")}}var m=function(){function e(t,n,r){a(this,e),this.id=t,this.type=n,this.data=r}var t,n,s;return t=e,(n=[{key:"genResp",value:function(t){return new e(this.id,this.type,t)}},{key:"deflate",value:function(){return{id:this.id,type:p(this.type),data:this.data}}}])&&r(t.prototype,n),s&&r(t,s),e}();s(m,"inflate",function(e){return new m(e.id,function(e){switch(e){case i:return h.updatePatterns;case o:return h.getPatterns;case u:return h.updateCalendars;case c:return h.getCalendars;case l:return h.getCalEvents;case f:return h.updateConfig;case d:return h.getConfig;default:console.error("unreachable")}}(e.type),e.data)});var j=function e(t){var n=this;a(this,e),s(this,"sendMsg",function(e){var t,a,r=e.type,s=e.data,i=n.requestCallback,o=new Promise(function(e){t=e});return a=i.ids.length>0?i.ids.pop():i.maxId++,i.inFlight[a]=t,n.port.postMessage(new m(a,r,s).deflate()),o});var r=chrome.runtime.connect({name:t});r.onMessage.addListener(function(e){console.log(e);var t=(e.type,n.requestCallback),a=t.inFlight[e.id];console.assert(void 0!==a),t.ids.push(e.id),a(e)}),this.port=r,this.requestCallback={inFlight:{},ids:[],maxId:0}}},301:function(e,t,n){var a={"./af":87,"./af.js":87,"./ar":88,"./ar-dz":89,"./ar-dz.js":89,"./ar-kw":90,"./ar-kw.js":90,"./ar-ly":91,"./ar-ly.js":91,"./ar-ma":92,"./ar-ma.js":92,"./ar-sa":93,"./ar-sa.js":93,"./ar-tn":94,"./ar-tn.js":94,"./ar.js":88,"./az":95,"./az.js":95,"./be":96,"./be.js":96,"./bg":97,"./bg.js":97,"./bm":98,"./bm.js":98,"./bn":99,"./bn.js":99,"./bo":100,"./bo.js":100,"./br":101,"./br.js":101,"./bs":102,"./bs.js":102,"./ca":103,"./ca.js":103,"./cs":104,"./cs.js":104,"./cv":105,"./cv.js":105,"./cy":106,"./cy.js":106,"./da":107,"./da.js":107,"./de":108,"./de-at":109,"./de-at.js":109,"./de-ch":110,"./de-ch.js":110,"./de.js":108,"./dv":111,"./dv.js":111,"./el":112,"./el.js":112,"./en-SG":113,"./en-SG.js":113,"./en-au":114,"./en-au.js":114,"./en-ca":115,"./en-ca.js":115,"./en-gb":116,"./en-gb.js":116,"./en-ie":117,"./en-ie.js":117,"./en-il":118,"./en-il.js":118,"./en-nz":119,"./en-nz.js":119,"./eo":120,"./eo.js":120,"./es":121,"./es-do":122,"./es-do.js":122,"./es-us":123,"./es-us.js":123,"./es.js":121,"./et":124,"./et.js":124,"./eu":125,"./eu.js":125,"./fa":126,"./fa.js":126,"./fi":127,"./fi.js":127,"./fo":128,"./fo.js":128,"./fr":129,"./fr-ca":130,"./fr-ca.js":130,"./fr-ch":131,"./fr-ch.js":131,"./fr.js":129,"./fy":132,"./fy.js":132,"./ga":133,"./ga.js":133,"./gd":134,"./gd.js":134,"./gl":135,"./gl.js":135,"./gom-latn":136,"./gom-latn.js":136,"./gu":137,"./gu.js":137,"./he":138,"./he.js":138,"./hi":139,"./hi.js":139,"./hr":140,"./hr.js":140,"./hu":141,"./hu.js":141,"./hy-am":142,"./hy-am.js":142,"./id":143,"./id.js":143,"./is":144,"./is.js":144,"./it":145,"./it-ch":146,"./it-ch.js":146,"./it.js":145,"./ja":147,"./ja.js":147,"./jv":148,"./jv.js":148,"./ka":149,"./ka.js":149,"./kk":150,"./kk.js":150,"./km":151,"./km.js":151,"./kn":152,"./kn.js":152,"./ko":153,"./ko.js":153,"./ku":154,"./ku.js":154,"./ky":155,"./ky.js":155,"./lb":156,"./lb.js":156,"./lo":157,"./lo.js":157,"./lt":158,"./lt.js":158,"./lv":159,"./lv.js":159,"./me":160,"./me.js":160,"./mi":161,"./mi.js":161,"./mk":162,"./mk.js":162,"./ml":163,"./ml.js":163,"./mn":164,"./mn.js":164,"./mr":165,"./mr.js":165,"./ms":166,"./ms-my":167,"./ms-my.js":167,"./ms.js":166,"./mt":168,"./mt.js":168,"./my":169,"./my.js":169,"./nb":170,"./nb.js":170,"./ne":171,"./ne.js":171,"./nl":172,"./nl-be":173,"./nl-be.js":173,"./nl.js":172,"./nn":174,"./nn.js":174,"./pa-in":175,"./pa-in.js":175,"./pl":176,"./pl.js":176,"./pt":177,"./pt-br":178,"./pt-br.js":178,"./pt.js":177,"./ro":179,"./ro.js":179,"./ru":180,"./ru.js":180,"./sd":181,"./sd.js":181,"./se":182,"./se.js":182,"./si":183,"./si.js":183,"./sk":184,"./sk.js":184,"./sl":185,"./sl.js":185,"./sq":186,"./sq.js":186,"./sr":187,"./sr-cyrl":188,"./sr-cyrl.js":188,"./sr.js":187,"./ss":189,"./ss.js":189,"./sv":190,"./sv.js":190,"./sw":191,"./sw.js":191,"./ta":192,"./ta.js":192,"./te":193,"./te.js":193,"./tet":194,"./tet.js":194,"./tg":195,"./tg.js":195,"./th":196,"./th.js":196,"./tl-ph":197,"./tl-ph.js":197,"./tlh":198,"./tlh.js":198,"./tr":199,"./tr.js":199,"./tzl":200,"./tzl.js":200,"./tzm":201,"./tzm-latn":202,"./tzm-latn.js":202,"./tzm.js":201,"./ug-cn":203,"./ug-cn.js":203,"./uk":204,"./uk.js":204,"./ur":205,"./ur.js":205,"./uz":206,"./uz-latn":207,"./uz-latn.js":207,"./uz.js":206,"./vi":208,"./vi.js":208,"./x-pseudo":209,"./x-pseudo.js":209,"./yo":210,"./yo.js":210,"./zh-cn":211,"./zh-cn.js":211,"./zh-hk":212,"./zh-hk.js":212,"./zh-tw":213,"./zh-tw.js":213};function r(e){var t=s(e);return n(t)}function s(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(a)},r.resolve=s,e.exports=r,r.id=301},31:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u});var o=function(){function e(t,n,r,s){a(this,e),this.id=t,this.isRegex=n,this.value=r,this.label=s}return s(e,[{key:"deflate",value:function(){return{id:this.id,isRegex:this.isRegex,value:this.value,label:this.label}}},{key:"regex",get:function(){return new RegExp(this.isRegex?this.value:"^".concat(this.value,"$"))}},{key:"isEmpty",get:function(){return null===this.label}}]),e}();i(o,"emptyPattern",function(){return new o(0,!0,"",null)}),i(o,"anyPattern",function(){return new o("any",!0,".*","Any")}),i(o,"inflate",function(e){return new o(e.id,e.isRegex,e.value,e.label)});var u=function(){function e(t,n,r,s){a(this,e),this.name=t,this.idx=n,this.cal=r,this.event=s}return s(e,[{key:"deflate",value:function(){return{name:this.name,idx:this.idx,cal:this.cal.deflate(),event:this.event.deflate()}}}]),e}();i(u,"defaultPatternEntry",function(e){return new u("",e,o.emptyPattern(),o.anyPattern())}),i(u,"inflate",function(e){return new u(e.name,e.idx,o.inflate(e.cal),o.inflate(e.event))})},32:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(3),r=n.n(a);function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i,o,u,c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.unit=n}var t,n,a;return t=e,a=[{key:"days",value:function(t){return new e(t,"days")}},{key:"weeks",value:function(t){return new e(t,"weeks")}},{key:"months",value:function(t){return new e(t,"months")}}],(n=[{key:"toMoment",value:function(){var e=r.a.duration(this.value,this.unit);return e.isValid()?e:null}},{key:"deflate",value:function(){return{value:this.value,unit:this.unit}}}])&&s(t.prototype,n),a&&s(t,a),e}();u=function(e){return new c(e.value,e.unit)},(o="inflate")in(i=c)?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u},62:function(e,t,n){"use strict";var a=n(27),r=n(65),s=n.n(r),i=Object(a.createMuiTheme)({palette:{primary:{light:s.a[300],main:s.a[500],dark:s.a[700],contrastText:"#fff"}},typography:{useNextVariants:!0}});t.a=i},79:function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"b",function(){return w}),n.d(t,"a",function(){return E});var a=n(1),r=n.n(a),s=n(0),i=n.n(s),o=n(27),u=n(33),c=n.n(u),l=n(283),f=n.n(l),d=n(80),h=n.n(d),p=n(290),m=n(230),j=n(68),v=n(289);function y(e,t,n,a,r){if(e>=t)return Promise.resolve({patternGraphData:[],calendarGraphData:[]});var s=[],i=function(i){var o=n.filter(function(e){return e.cal.regex.test(a[i].name)});o.length>0&&s.push(r(i,e,t).then(function(e){return{id:i,events:e,filtered:o}}))};for(var o in a)i(o);return Promise.all(s).then(function(r){var s={},i={},o={},u={};r.forEach(function(e){s[e.id]=e.events,i[e.id]=e.filtered});for(var c=0;c<n.length;c++)o[c]=0;var l=function(e){if(!s[e])return"continue";s[e].forEach(function(t){i[e].forEach(function(n){if(n.event.regex.test(t.summary)){u.hasOwnProperty(e)||(u[e]=0);var a=(t.end-t.start)/6e4;o[n.idx]+=a,u[e]+=a}})})};for(var f in a)l(f);for(var d=[],h=[],p=function(e){var t=0,n=[],a=0;return e.forEach(function(e){return t+=e.value}),e.forEach(function(e){e.value/t<.01?a+=e.value:n.push(e)}),n.push({name:"Other",value:a,color:"#fff"}),n},m=0;m<n.length;m++)d.push({name:n[m].name,value:o[m]/60});for(var f in u)h.push({name:a[f].name,value:u[f]/60,color:a[f].color.background});return{start:e,end:t,patternGraphData:p(d),calendarGraphData:p(h)}})}var b=function(e){return{pieChart:{margin:"0 auto"}}};function g(e){var t=e.cx,n=e.cy,a=e.x,s=e.y,i=e.fill,o=e.name,u="middle",c=0,l=0;return a<t-2?(c=-5,u="end"):a>t+2&&(c=5,u="start"),s<n-2?l=-5:s>n+2&&(l=10),r.a.createElement("text",{x:a,y:s,dx:c,dy:l,fill:i,textAnchor:u},"".concat(o))}var w=Object(o.withStyles)(b)(function(e){return r.a.createElement(c.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(p.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(m.a,{data:e.data,dataKey:"value",cx:200,cy:125,outerRadius:60,fill:f.a[300],isAnimationActive:!1,label:g}),r.a.createElement(j.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}}))))});function k(e){return r.a.createElement(c.a,{container:!0,spacing:0},r.a.createElement(w,{data:e.patternGraphData}),r.a.createElement(c.a,{item:!0,xs:12,lg:6},r.a.createElement("div",{className:e.classes.patternTableWrapper},r.a.createElement(p.a,{width:400,height:250,className:e.classes.pieChart},r.a.createElement(m.a,{data:e.calendarGraphData,dataKey:"value",cx:200,cy:125,innerRadius:40,outerRadius:70,fill:h.a[300],isAnimationActive:!1,label:g},e.calendarGraphData.map(function(e,t){return r.a.createElement(v.a,{key:t,fill:e.color})})),r.a.createElement(j.a,{formatter:function(e){return"".concat(e.toFixed(2)," hr")}})))))}k.propTypes={patternGraphData:i.a.array.isRequired,calendarGraphData:i.a.array.isRequired};var E=Object(o.withStyles)(b)(k)},853:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(29),i=n.n(s),o=n(247),u=n(27),c=n(45),l=n.n(c),f=n(36),d=n.n(f),h=n(62),p=n(31),m=n(32),j=n(28),v=n(79),y=n(3),b=n.n(y);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(){chrome.tabs.create({url:"index.html"})}var x=function(e){function t(e){var n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=k(t).call(this,e),n=!r||"object"!==g(r)&&"function"!=typeof r?P(a):r,C(P(P(n)),"state",{patternGraphData:[]}),C(P(P(n)),"getCalEvents",function(e,t,a){return n.msgClient.sendMsg({type:j.c.getCalEvents,data:{id:e,start:t.getTime(),end:a.getTime()}}).then(function(e){return e.data.map(function(e){return{id:e.id,start:new Date(e.start),end:new Date(e.end)}})})}),n.msgClient=new j.b("main");var s=n.msgClient.sendMsg({type:j.c.getPatterns,data:{id:"main"}}).then(function(e){n.patterns=e.data.map(function(e){return p.b.inflate(e)})}),i=n.msgClient.sendMsg({type:j.c.getCalendars,data:{enabledOnly:!1}}).then(function(e){n.calendars=e.data}),o=n.msgClient.sendMsg({type:j.c.getConfig,data:["trackedPeriods"]}).then(function(e){n.trackedPeriods=e.data.trackedPeriods.map(function(e){return{start:m.a.inflate(e.start),end:m.a.inflate(e.end),name:e.name}})});return Promise.all([s,i,o]).then(function(){for(var e=0;e<n.trackedPeriods.length;e++)n.renderChartData(e)}),n}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,r.a.Component),n=t,(a=[{key:"renderChartData",value:function(e){var t=this,n=this.trackedPeriods[e];console.log(this.trackedPeriods);var a=n.start.toMoment(),r=n.end.toMoment();if(a&&r){var s=b()().endOf("day");if(0==r.valueOf())switch(n.start.unit){case"days":s=b()().endOf("day");break;case"weeks":s=b()().endOf("week");break;case"months":s=b()().endOf("month")}var i=s.clone();return s.subtract(a),i.subtract(r),console.log(s,i),Object(v.c)(s.toDate(),i.toDate(),this.patterns,this.calendars,this.getCalEvents).then(function(n){var a=t.state.patternGraphData;a[e]={start:b()(n.start),end:b()(n.end),data:n.patternGraphData},t.setState({patternGraphData:a})})}}},{key:"render",value:function(){var e=this;return console.log(this.state.patternGraphData),r.a.createElement(u.MuiThemeProvider,{theme:h.a},r.a.createElement(l.a,{variant:"contained",color:"primary",onClick:O},"Dashboard"),this.state.patternGraphData.map(function(t,n){return r.a.createElement("div",{key:n},r.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textPrimary"},e.trackedPeriods[n].name),r.a.createElement(d.a,{variant:"caption",align:"center"},"".concat(t.start.format("ddd, MMM Do, YYYY")," -\n                    ").concat(t.end.format("ddd, MMM Do, YYYY"))),t.data.some(function(e){return e.value>.001})&&r.a.createElement(v.b,{data:t.data})||r.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textSecondary"},"No data available"))}))}}])&&w(n.prototype,a),s&&w(n,s),t}();i.a.render(r.a.createElement(x,null),document.getElementById("root")),o.a()}});